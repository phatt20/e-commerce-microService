# üõí ecom-micro

Microservices eCommerce Project (Learning Purpose)

## üìå Description
‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏ö eCommerce ‡πÅ‡∏ö‡∏ö Microservices ‡πÇ‡∏î‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞ Service ‡∏°‡∏µ Database ‡πÅ‡∏¢‡∏Å‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å Database per Service)  
‡πÉ‡∏ä‡πâ **Event-Driven Architecture** ‡∏ú‡πà‡∏≤‡∏ô **Kafka** ‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°‡∏Ç‡πâ‡∏≤‡∏° Service ‡∏î‡πâ‡∏ß‡∏¢ **Outbox Pattern + Saga Orchestration**

---

## ‚öôÔ∏è Services Overview

### üîê Auth Service (MongoDB)
- ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Credential ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô
- ‡∏≠‡∏≠‡∏Å JWT token ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö User
- ‡πÉ‡∏ä‡πâ **MongoDB** ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• User/Auth ‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô ‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏° Field ‡πÉ‡∏´‡∏°‡πà ‡πÜ ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢

---

### üë§ User Service (MongoDB)
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡∏∑‡πà‡∏≠, ‡∏≠‡∏µ‡πÄ‡∏°‡∏•, ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£)
- ‡πÉ‡∏ä‡πâ **MongoDB** ‡πÄ‡∏ä‡πà‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Auth ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ö‡πà‡∏≠‡∏¢‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô
- ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö Redis (Cache) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏†‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£ Query User ‡∏ö‡πà‡∏≠‡∏¢ ‡πÜ

---

### üì¢ Notification Service (MongoDB)
- ‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (‡∏≠‡∏µ‡πÄ‡∏°‡∏•, SMS, push notification)
- ‡πÉ‡∏ä‡πâ **MongoDB** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á Notification
- ‡∏£‡∏±‡∏ö Event ‡∏à‡∏≤‡∏Å Kafka ‡πÄ‡∏ä‡πà‡∏ô `order_created`, `payment_success`, `order_failed`

---

### üõí Order Service (PostgreSQL)
- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
- ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Order ‡πÄ‡∏ä‡πà‡∏ô `PENDING`, `PAID`, `CANCELLED`
- ‡πÉ‡∏ä‡πâ **Outbox Pattern** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Event (‡πÄ‡∏ä‡πà‡∏ô `order_created`) ‡∏•‡∏á Outbox table ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡πÑ‡∏õ Kafka
- Database ‚Üí **PostgreSQL** ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Transaction

---

### üì¶ Inventory Service (PostgreSQL)
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Stock ‡∏Ç‡∏≠‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Order ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á ‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏•‡∏î Stock
- ‡∏´‡∏≤‡∏Å Stock ‡πÑ‡∏°‡πà‡∏û‡∏≠ ‚Üí ‡∏™‡πà‡∏á Event `inventory_failed` ‡πÑ‡∏õ Kafka
- Database ‚Üí **PostgreSQL** ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Transaction ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î (ACID) ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Stock ‡∏•‡∏ö‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î

---

### üí≥ Payment Service (PostgreSQL)
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
- ‡∏£‡∏±‡∏ö Event `order_created` ‚Üí ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏ï‡∏±‡∏î‡πÄ‡∏á‡∏¥‡∏ô ‚Üí ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô `success` ‡∏´‡∏£‡∏∑‡∏≠ `failed`
- Database ‚Üí **PostgreSQL** ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏π‡∏á

---

### üîÑ Saga Orchestration Service (PostgreSQL)
- ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà **‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏° (Saga Pattern)** ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Service ‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß
- ‡πÄ‡∏Å‡πá‡∏ö **Saga State** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à/‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß ‚Üí ‡∏™‡πà‡∏á Event Rollback ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Service ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á (Compensation Transaction)

---

### üì§ Outbox Pattern
- ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô Service ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Event ‡∏•‡∏á DB ‡∏Å‡πà‡∏≠‡∏ô ‚Üí ‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∂‡∏á‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å Kafka ‡πÅ‡∏ö‡∏ö async
- ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤ **Lost Message** ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á DB ‡∏Å‡∏±‡∏ö Kafka
- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: Order Service ‚Üí ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô `order_created` ‡∏•‡∏á Outbox ‚Üí Worker ‡∏≠‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥ ‚Üí ‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ Kafka ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏ï‡∏±‡∏ß‡πÉ‡∏ô outbox ‡∏ó‡∏µ‡πà status ‡πÄ‡∏õ‡πá‡∏ô pending

---

## üõ∞Ô∏è Event Streaming (Kafka)
- ‡πÉ‡∏ä‡πâ Kafka ‡πÄ‡∏õ‡πá‡∏ô Event Bus ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Service
- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Event:
  - `order_created`
  - `inventory_reserved`
  - `inventory_failed`
  - `payment_success`
  - `payment_failed`
  - `order_cancelled`
  - `notification_send`

---

## üóÑÔ∏è Database Choices

- **MongoDB** ‚Üí Auth, User, Notification  
  üëâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô, ‡πÑ‡∏°‡πà fix schema ‡∏°‡∏≤‡∏Å, ‡πÄ‡∏ô‡πâ‡∏ô‡∏≠‡πà‡∏≤‡∏ô/‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡πá‡∏ß

- **PostgreSQL** ‚Üí Order, Inventory, Payment, Saga Orchestration, Outbox  
  üëâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á, ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Transaction ‡πÅ‡∏ö‡∏ö ACID, ‡∏Å‡∏≤‡∏£ Join ‡πÅ‡∏•‡∏∞ Consistency ‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô

---

## üìä topology Diagram
![topology Diagram](docs/ServiceTopology.jpg)

---
---

## üìä EVENT FLOW
![EVENT FLOW](docs/event.jpg)

---

---

## üìä System Diagram
![System Diagram](docs/version2.jpg)

---

## üìå Status
- Code: in-progress
- Diagram: in-progress

---

## üìú License
MIT License ¬© 2023 Phattharakon Konkasem  
‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å [hello-sekai-shop-microservices](https://github.com/Rayato159/hello-sekai-shop-microservices) (MIT License)
